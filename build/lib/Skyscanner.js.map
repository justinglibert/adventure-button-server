{"version":3,"sources":["../../lib/lib/Skyscanner.js"],"names":["querystring","QuoteSet","Skyscanner","constructor","api_key","base_url","setLocale","setMarket","setCurrency","setVersion","shortApiKey","substr","locale","version","market","currency","endpoint","parts","params","join","stringify","get","args","apiKey","last","length","pop","Object","assign","fetch","then","res","text","JSON","parse","locales","r","Locales","markets","Countries","currencies","Currencies","autosuggest","query","Places","autosuggestLocation","id","browsequotes","originPlace","destinationPlace","outboundPartialDate","inboundPartialDate","referral_url","referral","Quotes","Carriers"],"mappings":"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","file":"Skyscanner.js","sourcesContent":["import 'es6-promise';\nimport 'isomorphic-fetch';\nimport querystring from 'query-string';\n\nimport QuoteSet from './QuoteSet';\n\nexport default class Skyscanner {\n\n    constructor(api_key) {\n        this.api_key = api_key;\n        this.base_url = 'http://partners.api.skyscanner.net/apiservices/';\n\n        this.setLocale('en-GB');\n        this.setMarket('GB');\n        this.setCurrency('GBP');\n\n        this.setVersion('1.0');\n    }\n\n    shortApiKey() {\n        return this.api_key.substr(0, 16);\n    }\n\n    setLocale(locale) {\n        this.locale = locale;\n    }\n\n    setVersion(version) {\n        this.version = `v${version}`;\n    }\n\n    setMarket(market) {\n        this.market = market;\n    }\n\n    setCurrency(currency) {\n        this.currency = currency;\n    }\n\n    endpoint(parts, params) {\n        return `${this.base_url}${parts.join('/')}?${querystring.stringify(params)}`;\n    }\n\n    get(...args) {\n        let params = {apiKey: this.api_key};\n\n        var last = args[ args.length - 1 ];\n\n        if ( typeof last == 'object' ) {\n            args.pop(-1);\n            params = Object.assign(params, last);\n        }\n\n        const endpoint = this.endpoint(args, params);\n\n        return fetch(endpoint)\n            .then(res => {\n                return res.text()\n            })\n            .then(res => {\n                return JSON.parse(res);\n            });\n    }\n\n    locales() {\n        return this.get('reference', this.version, 'locales')\n            .then(r => r.Locales);\n    }\n\n    markets(locale = this.locale) {\n        return this.get('reference', this.version, 'countries', locale)\n            .then(r => r.Countries);\n    }\n\n    currencies() {\n        return this.get('reference', this.version, 'currencies')\n            .then(r => r.Currencies);\n    }\n\n\n    autosuggest(query) {\n        return this.get('autosuggest', this.version, this.market, this.currency, this.locale, {query})\n            .then(r => r.Places);\n    }\n\n    autosuggestLocation(id) {\n        return this.get('autosuggest', this.version, this.market, this.currency, this.locale, {id})\n        .then(r => r.Places);\n    }\n\n    browsequotes(originPlace, destinationPlace = 'everywhere', outboundPartialDate, inboundPartialDate) {\n        return this.get('browsequotes', this.version, this.market, this.currency, this.locale, originPlace, destinationPlace, outboundPartialDate, inboundPartialDate)\n            .then(r => {\n                const referral_url = this.referral(originPlace, destinationPlace, outboundPartialDate, inboundPartialDate)\n                return new QuoteSet(r.Quotes, r.Places, r.Carriers, r.Currencies, referral_url);\n            })\n    }\n\n    referral(originPlace, destinationPlace, outboundPartialDate, inboundPartialDate) {\n        outboundPartialDate = outboundPartialDate.substr(0, '2016-01-01'.length);\n        inboundPartialDate = inboundPartialDate.substr(0, '2016-01-01'.length);\n\n        return this.endpoint(['referral', this.version, this.market, this.currency, this.locale, originPlace, destinationPlace, outboundPartialDate, inboundPartialDate], {apiKey: this.shortApiKey()});\n    }\n}"]}